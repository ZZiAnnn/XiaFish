# 厦小鱼接口设计文档-V1.0

## 1.登录界面

### 1.1登录

#### 1.1.1 基本信息

> 请求路径：/login
> 请求方式：POST
> 接口描述：该接口用于用户登录，登录完毕之后，系统会下发一个JWT令牌

#### 1.1.2 请求参数

参数格式：application/json

参数说明：

| 名称     | 类型   | 是否必须 | 备注   |
| -------- | ------ | -------- | ------ |
| username | string | 必须     | 用户名 |
| password | string | 必须     | 密码   |

```json
{
	"username": "xiaoming",
    "password": "123456"
}
```

#### 1.1.3 响应数据

参数格式：application/json

参数说明：

| 名称 | 类型   | 是否必须 | 默认值 | 备注                     | 其他信息 |
| ---- | ------ | -------- | ------ | ------------------------ | -------- |
| code | number | 必须     |        | 响应码, 1 成功 ; 0  失败 |          |
| msg  | string | 非必须   |        | 提示信息                 |          |
| data | string | 必须     |        | 返回的数据 , jwt令牌     |          |



响应数据样例：

```json
{
  "code": 1,
  "msg": "success",
  "data": "eyJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoi6YeR5bq4IiwiaWQiOjEsInVzZXJuYW1lIjoiamlueW9uZyIsImV4cCI6MTY2MjIwNzA0OH0.KkUc_CXJZJ8Dd063eImx4H9Ojfrr6XMJ-yVzaWCVZCo"
}
```

#### 1.1.4 备注说明

> 用户登录成功后，系统会自动下发JWT令牌，然后在后续的每次请求中，都需要在请求头header中携带到服务端，请求头的名称为 token ，值为 登录时下发的JWT令牌。
>
> 如果检测到用户未登录，则会返回如下固定错误信息：
>
> ```json
> {
> 	"code": 0,
> 	"msg": "NOT_LOGIN",
> 	"data": null
> }
> ```
>

>jwt令牌说明：
>jwt令牌中会包含用户的数据库ID

### 1.2注册

#### 1.2.1 基本信息

>请求路径：/signup
>请求类型：post
>接口描述：该请求用于用户注册，用户名具有唯一性

#### 1.2.2 请求参数

| 名称     | 类型   | 是否必须 | 备注   |
| -------- | ------ | -------- | ------ |
| username | string | 必须     | 用户名 |
| password | string | 必须     | 密码   |

```json
{
	"username": "xiaoming",
    "password": "123456"
}
```

#### 1.2.3 响应数据

参数格式：application/json

参数说明：

| 名称 | 类型   | 是否必须 | 默认值 | 备注                     | 其他信息 |
| ---- | ------ | -------- | ------ | ------------------------ | -------- |
| code | number | 必须     |        | 响应码, 1 成功 ; 0  失败 |          |
| msg  | string | 非必须   |        | 提示信息                 |          |
| data | string | 非必须   |        |                          |          |

响应数据举例：

```json
{
  "code": 1,
  "msg": "success",
  "data": 
}
```

#### 1.2.4 备注说明

>当用户的用户名不唯一的时候会通过msg返回注册失败
>
>```json
>{
>  "code": 0,
>  "msg": "the username has existed",
>  "data": 
>}
>```

## 2.个人信息主页

### 2.1 个人信息查询

#### 2.1.1 基本信息

>请求路径：/user
>请求方式：GET
>接口描述：用于查询指定用户的个人信息，其中对应的用户ID从jwt令牌中解析获取

#### 2.1.2 请求参数

无

#### 2.1.3 响应数据

参数格式：application/json

| 名称         | 类型   | 是否必须 | 默认值 | 备注                    | 其他信息 |
| ------------ | ------ | -------- | ------ | ----------------------- | -------- |
| code         | number | 必须     |        | 响应码, 1 成功 , 0 失败 |          |
| msg          | string | 非必须   |        | 提示信息                |          |
| data         | object | 必须     |        | 返回的数据              |          |
| \|- id       | number | 必须     |        | id                      |          |
| \|- username | string | 必须     |        | 用户名                  |          |
| \|- name     | string | 非必须   |        | 名称                    |          |
| \|- gender   | number | 非必须   |        | 性别 , 1 男 ; 2 女      |          |
| \|-phone     | string | 非必须   |        | 联系方式                |          |
| \|- email    | string | 非必须   |        | 邮箱地址                |          |
| \|-profile   | string | 非必须   |        | 个人简介                |          |
| \|-image     | string | 非必须   |        | 头像                    |          |
|              |        |          |        |                         |          |
|              |        |          |        |                         |          |

响应数据举例

### 2.2 修改个人信息

>请求路径：user/update
>请求类型：PUT
>接口描述：该接口用于修改用户的个人信息（邮箱、手机号码等数据格式的校验由前端完成）

### 2.3 查询发布的商品

> 请求路径：user/goods
> 请求类型：GET
> 接口描述：该接口用于展示用于发布的商品

### 2.4 发布商品

>请求路径：user/goods
>请求类型：PUT
>接口描述：该接口用于发布商品

### 2.5 删除商品

>请求路径：user/goods
>请求类型：DELETE
>接口描述：该接口用于下架已经发布的商品

### 2.6查询历史订单

>请求路径：user/order
>请求类型：GET
>接口描述：该接口用于查询用户的历史订单信息

### 2.7 查询我的评价

>请求路径：user/comment
>请求类型：GET
>接口描述：该接口用于查询用户对已经购买商品的评价

### 2.8 查询我的购物车

>请求路径：user/shoppingcart
>请求类型：GET
>接口描述：该接口用于查询用户的购物车信息

## 3.主页面

### 3.1查询商品

>请求路径：goods/all
>请求类型：POST
>接口描述：该接口用于查询所有的商品信息，并且在主页面中进行展示，默认按照商品的上架时间排序

## 4.商品详情页

### 4.1查询商品详情信息

>请求路径：goods/
>请求类型：GET
>接口描述：该接口用于分页查询对应商品的详细信息

### 4.2 加入购物车

>请求路径：goods/shoppingcart
>请求类型：PUT
>接口描述：该接口用于将商品加入购物车

### 4.3立即购买

>请求路径：goods/purchase
>请求类型：POST
>接口描述：该接口用于购买对应的商品（当购买的数量大于库存返回错误）

## 5.管理员界面

### 5.1查询所有用户

>请求路径：admin/user
>请求类型：POST
>接口描述：该接口用于分页查询符合条件的用户

### 5.2删除用户

>请求路径：admin/delete
>请求类型：delete
>接口描述：该接口用于删除用户

### 5.3增加用户

>请求路径：admin/add
>请求类型：POST
>接口描述：该接口用于增加用户

### 5.4修改用户

>请求路径：admin/update
>请求类型：PUT
>接口描述：修改用户信息

### 5.5历史订单查询

>请求路径：admin/orders
>请求类型：POST
>接口描述：查询所有的历史订单，可以根据用户名进行筛选

## 7.购物车

### 7.1购物车查询

>请求路径：shoppingcart/
>请求类型：POST
>接口描述：获取购物车中的商品信息

### 7.2 修改商品的数量

>请求路径：shoppingcart/update
>请求类型：PUT
>接口描述：修改加入购物车的数量，由前端来保证加入购物车的数量小于等于库存数量

### 7.3 立即购买

>请求路径：shoppingcart/buy
>请求类型：POST
>接口描述：直接在购物车界面下单

### 7.4 取消加入购物车

>请求路径：shopping/delete
>请求类型：DELETE
>接口描述：取消加入购物车

## 8.私聊界面

### 8.1查询记录

...

